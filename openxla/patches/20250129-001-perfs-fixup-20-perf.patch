From 856422f8efe1462832fa67df2519a9822cf8cd75 Mon Sep 17 00:00:00 2001
From: Jean-Baptiste Dalido <jb@zml.ai>
Date: Wed, 29 Jan 2025 15:42:34 +0000
Subject: [PATCH] perfs: fixup -20% perf

PR: https://github.com/openxla/xla/pull/22081
---
 xla/service/gpu/gpu_compiler.cc | 1 +
 1 file changed, 1 insertion(+)

diff --git a/xla/service/gpu/gpu_compiler.cc b/xla/service/gpu/gpu_compiler.cc
index 285ef1a2f1..e356e9d345 100755
--- a/xla/service/gpu/gpu_compiler.cc
+++ b/xla/service/gpu/gpu_compiler.cc
@@ -818,6 +818,7 @@ absl::Status RunOptimizationPasses(
     pipeline.AddPass<HloConstantFolding>();
     pipeline.AddPass<ConditionalSimplifier>();
     pipeline.AddPass<RealImagExpander>();
+    pipeline.AddPass<TransposeFolding>(CanFoldTransposeOperandIntoDot);
     pipeline.AddPass<HloCSE>(/*is_layout_sensitive=*/false);
     pipeline.AddPass<HloDCE>();
   }();
-- 
2.34.1
